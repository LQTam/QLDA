{"ast":null,"code":"var _jsxFileName = \"/home/dev/ictu/qlda/QLDA/src/components/Register/index.js\";\nimport React from 'react'; // import { base } from '../../Firebaseconntion';\n\nimport { Toaster, Intent } from '@blueprintjs/core';\nimport { withRouter, Redirect, Link } from 'react-router-dom';\nimport * as ROLES from '../../constants/roles';\nimport { THONGKE, SIGN_IN } from '../../constants/routes';\nimport { withFirebase } from '../Firebase';\nimport { compose } from 'recompose';\nimport { AuthUserContext } from '../Session';\nconst INITIAL_STATE = {\n  email: '',\n  password: '',\n  isAdmin: false,\n  error: null\n};\n\nconst Register = () => React.createElement(AuthUserContext.Consumer, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 18\n  },\n  __self: this\n}, authUser => authUser ? React.createElement(Redirect, {\n  to: THONGKE,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 20\n  },\n  __self: this\n}) : React.createElement(SignUpForm, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 21\n  },\n  __self: this\n}));\n\nclass SignUpFormBase extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleRegister = async event => {\n      event.preventDefault();\n      const _event$target$element = event.target.elements,\n            email = _event$target$element.email,\n            password = _event$target$element.password;\n\n      try {\n        const roles = [];\n\n        if (this.state.isAdmin) {\n          roles.push(ROLES.ADMIN);\n        }\n\n        this.props.firebase.doCreateUserWithEmailAndPassword(email.value, password.value).then(authUser => {\n          return this.props.firebase.user(authUser.user.uid).set({\n            email: email.value,\n            uid: authUser.user.uid,\n            roles\n          }).then(() => {\n            this.setState({\n              INITIAL_STATE\n            });\n            this.props.history.push(THONGKE);\n          }).catch(err => {\n            this.toaster.show({\n              intent: Intent.DANGER,\n              message: err.message\n            });\n            this.setState({\n              error: err.message\n            });\n          });\n        }).catch(err => {\n          this.toaster.show({\n            intent: Intent.DANGER,\n            message: err.message\n          });\n          this.setState({\n            error: err.message\n          });\n        });\n        this.props.history.push(THONGKE);\n      } catch (err) {\n        this.toaster.show({\n          intent: Intent.DANGER,\n          message: err.message\n        });\n      }\n    };\n\n    this.googleLogin = async () => {\n      try {\n        const roles = [];\n\n        if (this.state.isAdmin) {\n          roles.push(ROLES.ADMIN);\n        }\n\n        this.props.firebase.doSignInWithGoogle().then(authUser => {\n          return this.props.firebase.user(authUser.user.uid).set({\n            email: authUser.user.email,\n            uid: authUser.user.uid,\n            roles\n          }).then(() => {\n            this.props.history.push(THONGKE);\n          }).catch(err => {\n            this.toaster.show({\n              intent: Intent.DANGER,\n              message: err.message\n            });\n            this.setState({\n              error: err.message\n            });\n          });\n        }).catch(err => {\n          this.toaster.show({\n            intent: Intent.DANGER,\n            message: err.message\n          });\n          this.setState({\n            error: err.message\n          });\n        });\n        ;\n        this.setState({\n          redirect: true\n        });\n      } catch (err) {\n        this.toaster.show({\n          intent: Intent.DANGER,\n          message: 'Unable to sign in with google.'\n        });\n      }\n    };\n\n    this.state = {\n      INITIAL_STATE\n    };\n  }\n\n  render() {\n    if (this.props.authenticated === true) {\n      this.props.history.push(THONGKE);\n    }\n\n    return React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }), \"  \", React.createElement(\"p\", {\n      className: \"text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, React.createElement(Toaster, {\n      ref: element => this.toaster = element,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    })), React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"card bg-light\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(\"article\", {\n      className: \"card-body mx-auto\",\n      style: {\n        maxWidth: '400px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"card-title mt-3 text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, \"Create Account\"), React.createElement(\"p\", {\n      className: \"text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, \"Get started with your free account\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"#\",\n      onClick: () => this.googleLogin(),\n      className: \"btn btn-block\",\n      style: {\n        backgroundColor: '#DD4B39'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, \" \", React.createElement(\"i\", {\n      className: \"fa fa-google\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }), \" \\xA0 Login via Google\")), React.createElement(\"p\", {\n      className: \"divider-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"bg-light\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, \"OR\")), React.createElement(\"form\", {\n      action: \"#\",\n      onSubmit: event => this.handleRegister(event),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form-group input-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"input-group-prepend\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"input-group-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, \" \", React.createElement(\"i\", {\n      className: \"fa fa-envelope\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }), \" \")), React.createElement(\"input\", {\n      name: \"email\",\n      className: \"form-control\",\n      placeholder: \"Email address\",\n      type: \"email\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    })), \" \", React.createElement(\"div\", {\n      className: \"form-group input-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"input-group-prepend\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"input-group-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, \" \", React.createElement(\"i\", {\n      className: \"fa fa-lock\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }), \" \")), React.createElement(\"input\", {\n      name: \"password\",\n      className: \"form-control\",\n      placeholder: \"Create password\",\n      type: \"password\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    })), \" \", React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-primary btn-block\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }, \" Create Account\")), \" \", React.createElement(\"p\", {\n      className: \"text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, \"Have an account? \", React.createElement(Link, {\n      to: SIGN_IN,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, \"Sign In\"), \" \")))));\n  }\n\n}\n\nconst SignUpForm = compose(withRouter, withFirebase)(SignUpFormBase);\nexport default Register;","map":{"version":3,"sources":["/home/dev/ictu/qlda/QLDA/src/components/Register/index.js"],"names":["React","Toaster","Intent","withRouter","Redirect","Link","ROLES","THONGKE","SIGN_IN","withFirebase","compose","AuthUserContext","INITIAL_STATE","email","password","isAdmin","error","Register","authUser","SignUpFormBase","Component","constructor","props","handleRegister","event","preventDefault","target","elements","roles","state","push","ADMIN","firebase","doCreateUserWithEmailAndPassword","value","then","user","uid","set","setState","history","catch","err","toaster","show","intent","DANGER","message","googleLogin","doSignInWithGoogle","redirect","render","authenticated","element","maxWidth","backgroundColor","SignUpForm"],"mappings":"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","sourcesContent":["import React from 'react'\n// import { base } from '../../Firebaseconntion';\nimport { Toaster, Intent } from '@blueprintjs/core'\nimport { withRouter, Redirect, Link } from 'react-router-dom'\nimport * as ROLES from '../../constants/roles';\nimport { THONGKE, SIGN_IN } from '../../constants/routes';\nimport { withFirebase } from '../Firebase';\nimport { compose } from 'recompose';\nimport { AuthUserContext } from '../Session';\nconst INITIAL_STATE = {\n    email: '',\n    password: '',\n    isAdmin: false,\n    error: null,\n};\n\nconst Register = () => (\n    <AuthUserContext.Consumer>\n        {authUser =>\n            authUser ? <Redirect to={THONGKE} /> : (\n                <SignUpForm />\n            )}\n    </AuthUserContext.Consumer>\n)\n\nclass SignUpFormBase extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = { INITIAL_STATE };\n    }\n    handleRegister = async event => {\n        event.preventDefault();\n        const { email, password } = event.target.elements;\n\n        try {\n            const roles = [];\n\n            if (this.state.isAdmin) {\n                roles.push(ROLES.ADMIN);\n            }\n\n            this.props.firebase.doCreateUserWithEmailAndPassword(email.value, password.value)\n                .then(authUser => {\n                    return this.props.firebase\n                        .user(authUser.user.uid)\n                        .set({\n                            email: email.value,\n                            uid: authUser.user.uid,\n                            roles,\n                        })\n                        .then(() => {\n                            this.setState({ INITIAL_STATE });\n                            this.props.history.push(THONGKE);\n                        })\n                        .catch(err => {\n                            this.toaster.show({ intent: Intent.DANGER, message: err.message })\n                            this.setState({ error: err.message })\n                        });\n                })\n                .catch(err => {\n                    this.toaster.show({ intent: Intent.DANGER, message: err.message })\n                    this.setState({ error: err.message })\n                });\n\n            this.props.history.push(THONGKE)\n        }\n        catch (err) {\n            this.toaster.show({ intent: Intent.DANGER, message: err.message })\n        }\n\n    }\n\n    googleLogin = async () => {\n        try {\n            const roles = [];\n\n            if (this.state.isAdmin) {\n                roles.push(ROLES.ADMIN);\n            }\n            this.props.firebase.doSignInWithGoogle()\n                .then(authUser => {\n                    return this.props.firebase\n                        .user(authUser.user.uid)\n                        .set({\n                            email: authUser.user.email,\n                            uid: authUser.user.uid,\n                            roles,\n                        })\n                        .then(() => {\n                            this.props.history.push(THONGKE);\n                        })\n                        .catch(err => {\n                            this.toaster.show({ intent: Intent.DANGER, message: err.message })\n                            this.setState({ error: err.message })\n                        });\n                })\n                .catch(err => {\n                    this.toaster.show({ intent: Intent.DANGER, message: err.message })\n                    this.setState({ error: err.message })\n                });;\n            this.setState({ redirect: true })\n        }\n        catch (err) {\n            this.toaster.show({ intent: Intent.DANGER, message: 'Unable to sign in with google.' })\n        }\n    }\n\n    render() {\n        if (this.props.authenticated === true) {\n            this.props.history.push(THONGKE)\n        }\n\n        return (\n            <div className=\"container\">\n                <br />  <p className=\"text-center\"><Toaster ref={element => this.toaster = element} /></p>\n                <hr />\n                <div className=\"card bg-light\">\n                    <article className=\"card-body mx-auto\" style={{ maxWidth: '400px' }}>\n                        {/* <p><Toaster ref={element => this.toaster = element} /></p> */}\n                        <h4 className=\"card-title mt-3 text-center\">Create Account</h4>\n                        <p className=\"text-center\">Get started with your free account</p>\n                        <p>\n                            <a href='#' onClick={() => this.googleLogin()} className=\"btn btn-block\" style={{ backgroundColor: '#DD4B39' }}> <i className=\"fa fa-google\" /> &nbsp; Login via Google</a>\n                        </p>\n                        <p className=\"divider-text\">\n                            <span className=\"bg-light\">OR</span>\n                        </p>\n                        <form action=\"#\" onSubmit={(event) => this.handleRegister(event)}>\n                            <div className=\"form-group input-group\">\n                                <div className=\"input-group-prepend\">\n                                    <span className=\"input-group-text\"> <i className=\"fa fa-envelope\" /> </span>\n                                </div>\n                                <input name='email' className=\"form-control\" placeholder=\"Email address\" type=\"email\" />\n                            </div> {/* form-group// */}\n\n\n                            <div className=\"form-group input-group\">\n                                <div className=\"input-group-prepend\">\n                                    <span className=\"input-group-text\"> <i className=\"fa fa-lock\" /> </span>\n                                </div>\n                                <input name='password' className=\"form-control\" placeholder=\"Create password\" type=\"password\" />\n                            </div> {/* form-group// */}\n\n                            <div className=\"form-group\">\n                                <button type=\"submit\" className=\"btn btn-primary btn-block\"> Create Account</button>\n                            </div> {/* form-group// */}\n                            <p className=\"text-center\">Have an account? <Link to={SIGN_IN}>Sign In</Link> </p>\n                        </form>\n                    </article>\n                </div>\n            </div>\n        )\n    }\n}\n\nconst SignUpForm = compose(\n    withRouter,\n    withFirebase\n)(SignUpFormBase);\n\nexport default (Register);"]},"metadata":{},"sourceType":"module"}